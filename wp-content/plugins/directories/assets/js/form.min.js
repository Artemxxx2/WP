"use strict";!function(d){DRTS.Form={field:{}},DRTS.Form.form=function(e){var r=d(e),t=void 0;if(r.length)return(t=r.closest("."+DRTS.bsPrefix+"modal").length?d("#drts-modal"):r).find("button[type=submit]:not(:disabled)").click(function(e){var t=d(this);r.find("[data-clear-placeholder]").each(function(){var e=d(this);e.data("clear-placeholder")&&e.val()==e.attr("placeholder")&&e.val("")}),DRTS.Form.appendInvisibleFieldNames(r),r.append(d("<input>",{type:"hidden",name:t.attr("name"),value:t.val()})),(r.data("force-submit")||t.closest("."+DRTS.bsPrefix+"modal-footer").length)&&(r.data("force-submit",!1),r.submit())}).end().submit(function(e){e.isDefaultPrevented()||DRTS.Form._maybeDisableSubmitBtn(t)}),r.data("allow-enter-submit")||DRTS.Form.preventEnterKeySubmit(r),"undefined"!=typeof acf&&(acf.validation.active=!1),r},DRTS.Form.ajaxForm=function(e,n,s,i){var o=d(e);if(o.length)return(o.closest("."+DRTS.bsPrefix+"modal").length?d("#drts-modal"):o).find("button[type=submit]:not(:disabled)").click(function(e){var t=d(this),r=!1;if(o.find("input[type^=file]").each(function(){if(d(this).attr("value"))return!(r=!0)}),r)return!0;if(o.find("[data-clear-placeholder]").each(function(){var e=d(this);e.data("clear-placeholder")&&e.val()==e.attr("placeholder")&&e.val("")}),DRTS.Form.appendInvisibleFieldNames(o),o.append(d("<input>",{type:"hidden",name:t.attr("name"),value:t.val()})),t.hasClass("drts-form-back-btn-no-ajax"))return!0;e.preventDefault(),o.trigger("form_ajax_submit.sabai");var a={trigger:t,type:o.attr("method"),container:n,target:i.target||"",url:s,data:o.serialize(),scroll:!1,onSuccess:i.onSuccess||null,onError:function(e,t,r,a){DRTS.Form.handleError(o,e,t,r,a,i)},onContent:i.onContent||null,onReadyState:i.onReadyState||null,onSuccessFlash:i.onSuccessFlash||!1,onSuccessRedirect:i.onSuccessRedirect||!1,onErrorFlash:!1,onErrorRedirect:i.onErrorRedirect||!1,loadingImage:i.loadingImage||!1,modalHideOnSend:i.modalHideOnSend||!1,modalHideOnSuccess:i.modalHideOnSuccess||!1};i.onSubmit&&i.onSubmit(o,t,a),DRTS.ajax(a)}).end().submit(function(e){e.isDefaultPrevented()||DRTS.Form._maybeDisableSubmitBtn(o)}),o.data("allow-enter-submit")||DRTS.Form.preventEnterKeySubmit(o),o},DRTS.Form.preventEnterKeySubmit=function(e){d(e).on("keypress","input:not(textarea),select",function(e){13===(e.keyCode||e.charCode||0)&&e.preventDefault()})},DRTS.Form._maybeDisableSubmitBtn=function(e){var t=e.find("button[type=submit]");t.length&&(t.hasClass("drts-form-field-submit-safari-no-disable")&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||t.prop("disabled",!0))},window.onpageshow=function(e){e.persisted&&d(".drts-form button[type=submit]").prop("disabled",!1)},DRTS.Form.handleError=function(e,t,r,a,n,s){s=d.extend({},s),422===n?(DRTS.Form.handle422Error(e,t),s.scroll&&DRTS.scrollTo(e,1e3)):(s.onError&&s.onError(t,r,a,n),t.messages.length&&DRTS.Form.addFormErrorHeaders(e,t.messages))},DRTS.Form.addFormErrorHeaders=function(e,t){var r=e.prev(".drts-form-headers");if(r.length){r.text("");for(var a=0;a<t.length;a++)r.append(d('<div class="'+DRTS.bsPrefix+"alert "+DRTS.bsPrefix+'alert-danger"></div>').text(t[a]))}},DRTS.Form.handle422Error=function(n,e){var s=e.messages||[];d.each(e.errors,function(e,t){if(""!==e){var r=n.find('[name="'+e+'"]');if(r.length||(r=n.find('[data-form-field-name="'+e+'"]')),r.length){var a=r.closest(".drts-form-field");a.length&&(a.addClass("drts-form-has-error").find(".drts-form-error").text(t),a.hasClass("drts-form-states-invisible")?a.removeClass("drts-form-states-invisible").show():a.closest(".drts-form-states-invisible").length&&a.closest(".drts-form-states-invisible").removeClass("drts-form-states-invisible").show())}}else s.push(t)}),s.length&&DRTS.Form.addFormErrorHeaders(n,s)},DRTS.Form.appendInvisibleFieldNames=function(e,t){var r=e.find(".drts-form-states-invisible"),a=d(".drts-form-type-select").filter(function(){var e=d(this);return"none"===e.css("display")&&!e.hasClass("drts-form-states-invisible")});if(a.length&&(r=r.add(a)),r.length){var n=[];r.each(function(e,t){var r=d(t);r.hasClass("drts-display-element")&&r.find("> .drts-entity-form-field").length&&(r=r.find("> .drts-entity-form-field").first()),r.data("form-field-name")&&n.push(r.data("form-field-name")),r.find("[data-form-field-name]").each(function(e,t){n.push(d(t).data("form-field-name"))})}),e.append(d("<input>",{type:"hidden",name:t?t+"[_drts_form_invisible_fields]":"_drts_form_invisible_fields",value:n.join(",")}))}}}(jQuery);