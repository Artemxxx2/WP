"use strict";!function(c){DRTS.View=DRTS.View||{},DRTS.View.filterForm=DRTS.View.filterForm||function(a){var e,o,f=c(a);f.parent(".drts-view-entities-filter-form").length&&f.parent(".drts-view-entities-filter-form").css("display",""),(e=c(f.data("entities-container"))).length&&(o=e.find(f.data("entities-target"))).length&&o.off("click").on("click",".drts-view-entities-filters-applied .drts-view-remove-filter",function(e){var t=c(this);e.preventDefault(),t.remove(),t.data("filter-name")?DRTS.View.removeFilter(f,t.data("filter-name"),t.data("filter-value")):o.find(".drts-view-entities-filters-applied .drts-view-remove-filter").each(function(){var e=c(this);e.remove(),DRTS.View.removeFilter(f,e.data("filter-name"),e.data("filter-value"))}),f.submit()}),f.on("submit",function(e,t){if(f.find("[placeholder]").each(function(){var e=c(this);e.val()==e.attr("placeholder")&&e.val("")}),o&&o.length){e.preventDefault();var i,a=f.serialize(),r=o.find(".drts-view-entities-sort-selected").data("value"),n=o.find(".drts-view-entities-perpage-selected").data("value"),s=f.attr("action"),l=c(f.data("entities-container")+"-view-filter-form"),d=!(!f.closest("#drts-modal").length||!f.is(":visible"));r&&(a+="&sort="+r),n&&(a+="&num="+n),i={type:"post",container:f.data("entities-container"),target:f.data("entities-target"),url:s,data:a,pushState:!!f.data("push-state"),pushStateUrl:s+(-1<s.indexOf("?")?"&":"?")+a,scroll:0===f.data("scroll-offset")||!(f.data("scroll-offset")<0)&&f.data("scroll-offset"),loadingImage:!0,trigger:t&&t.trigger?t.trigger:null},d&&c("#drts-modal").sabaiModal("hide"),f.data("external")&&(i.url+=(-1<i.url.indexOf("?")?"&":"?")+DRTS.params.contentType+"=json",i.onContent=function(e,t,i,a){c("body > .select2-container").remove(),f.remove(),l.html(e.html[".drts-view-entities-filter-form"]),DRTS.init(l)},i.onError=function(e,t,i,a){}),l.data("collapsible")&&l.sabaiCollapse("hide"),DRTS.ajax(i)}}).on("change.sabai",function(e){if(!f.hasClass("drts-view-filter-form-manual")&&!f.closest("#drts-modal").length){var t=c(e.target),i=t.closest(".drts-view-filter-ignore");if(i.length){if(!i.data("ignore-element-name")||void 0===i.data("ignore-element-value"))return;var a=i.find('[name="'+i.data("ignore-element-name")+'"]');if(a.length&&a.attr("name")!==t.attr("name")&&a.val()===i.data("ignore-element-value"))return}f.submit()}}).find(".drts-view-filter-trigger").on("click",function(e){e.preventDefault(),f.trigger("submit",{trigger:c(this)})}),f.closest("#drts-modal").length&&(c("#drts-modal").find(".drts-form-buttons").find("button").on("click",function(e){e.preventDefault(),c(this).addClass(DRTS.bsPrefix+"disabled"),f.submit()}),f.find("."+DRTS.bsPrefix+"card-group-none").removeClass(DRTS.bsPrefix+"card-group-none").addClass(DRTS.bsPrefix+"card-group"));c("#drts-content").on("entity_entities_filter_removed.sabai",function(e,t,i){DRTS.View.removeFilter(c(a),t,i)}),c(DRTS).on("location_exit_fullscreen.sabai",function(e,t){c("#drts-modal").find("."+DRTS.bsPrefix+"modal-title,."+DRTS.bsPrefix+"modal-body,."+DRTS.bsPrefix+"modal-footer").empty()}),c(DRTS).on("drts_hidden.sabai",function(e,t){t.element.parent().hasClass(DRTS.bsPrefix+"card-body")&&t.element.closest("."+DRTS.bsPrefix+"card").hide()}),c(DRTS).on("drts_shown.sabai",function(e,t){t.element.parent().hasClass(DRTS.bsPrefix+"card-body")&&t.element.closest("."+DRTS.bsPrefix+"card").show()})},DRTS.View.removeFilter=DRTS.View.removeFilter||function(e,t,i){if(t){var a=e.find('[data-view-filter-name="'+t+'"]');if(!a.length)return;switch(a.data("view-filter-form-type")){case"textfield":case"hidden":a.find('input[name="'+t+'"]').length?a.find('input[name="'+t+'"]').val(""):a.find('input[name^="'+t+'["]').val("");break;case"checkboxes":i?a.find('input:checkbox[value="'+i+'"]').prop("checked",!1):a.find('input:checkbox[name="'+t+'[]"]').prop("checked",!1);break;case"radios":i?a.find('input:radio[value="'+i+'"]').prop("checked",!1):a.find('input:radio[name="'+t+'"]').prop("checked",!1),a.find('input:radio[value=""]').prop("checked",!0);break;case"select":var r=a.find('select[name^="'+t+'["]');r.length?r.each(function(e){var t=c(this);0<e?t.val("").closest(".drts-form-type-select").hide():t.val(""),t.hasClass("select2-hidden-accessible")&&t.select2("close")}):a.find('select[name="'+t+'"]').val("");break;case"slider":var n=a.find(".drts-form-slider");n.length&&n.data("ionRangeSlider").update({from:n.data("min"),to:n.data("max")})}var s=a.find(".drts-entity-reset-form-field-target");(s.length?s:a).trigger("entity_reset_form_field.sabai",[t])}else e.find(".drts-view-filter-form-field").each(function(){var e=c(this);e.data("view-filter-name")&&c("#drts-content").trigger("entity_entities_filter_removed.sabai",[e.data("view-filter-name"),null,!0])})}}(jQuery);