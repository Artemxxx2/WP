"use strict";!function(u){DRTS.Form.field.datepicker=function(e){var t,a,s,n,i,r,o,l,c;if((t=u(e)).length&&(a=t.find(".drts-form-datepicker-date")).length&&(s=t.find(".drts-form-datepicker-date-val")).length){n=t.find(".drts-clear"),(c=a.data("calendar-options")).actions={clickDay:function(e,t){if(!t.length)return a.val(""),void s.val("");switch(f.settings.selection.day){case"single":g.hide();break;case"multiple-ranged":if(t.length<=1)return;g.hide()}if(1<t.length){t.sort(function(e,t){return+new Date(e)-+new Date(t)});var n=(t=[t[0],t[t.length-1]]).map(function(e){return new Date(e).toLocaleString([],{year:"numeric",month:"long",day:"numeric",timeZone:DRTS.timeZone})});"multiple"===f.settings.selection.day?a.val(n.join(", ")):"multiple-ranged"===f.settings.selection.day&&a.val(n.join(" to ")),s.val(t.join(","))}else d(f,t[0]);m()},clickMonth:function(e,t){"month"===f.type&&(g.hide(),s.val(f.selectedYear+"-"+(t+1)+"-1"),a.val(new Date(f.selectedYear+"-"+(t+1)+"-1").toLocaleString([],{year:"numeric",month:"long",timeZone:DRTS.timeZone})),m())},changeTime:function(e,t,n,i,a){f.selectedDates.length&&(d(f,f.selectedDates[0]),m())}};var d=function(e,t){var n={year:"numeric",month:"long",day:"numeric",timeZone:DRTS.timeZone};e.settings.selection.time&&(n.hour12=24!==e.settings.selection.time,n.hour="numeric",n.minute="numeric",e.selectedTime&&(t+=" "+e.selectedTime));var i=new Date(t).toLocaleString([],n);a.val(i),s.val(t)},m=function(){n.length&&n.css("visibility",0<s.val().length?"visible":"hidden"),g.is(":hidden")&&g.closest("form").trigger("change.sabai")};if(c.settings.selected&&c.settings.selected.dates)switch(c.type){case"year":case"month":i=c.settings.selected.dates[0],l=new Date(i),c.settings.selected.year=Number(l.getFullYear()),c.settings.selected.dates=null,o="month"===c.type?(c.settings.selected.month=l.getMonth(),l.toLocaleString([],{year:"numeric",month:"long",timeZone:DRTS.timeZone})):l.toLocaleString([],{year:"numeric",timeZone:DRTS.timeZone}),a.val(o),s.val(i);break;default:"multiple-ranged"===c.settings.selection.day?(o=(i=c.settings.selected.dates[0]).split(",").map(function(e){return new Date(e).toLocaleString([],{year:"numeric",month:"long",day:"numeric",timeZone:DRTS.timeZone})}),a.val(o.join(" to ")),s.val(i)):"multiple"===c.settings.selection.day?(o=(i=c.settings.selected.dates).map(function(e){return new Date(e).toLocaleString([],{year:"numeric",month:"long",day:"numeric",timeZone:DRTS.timeZone})}),a.val(o.join(", ")),s.val(i.join(","))):(i=c.settings.selected.dates[0],r={year:"numeric",month:"long",day:"numeric",timeZone:DRTS.timeZone},c.settings.selection.time&&(c.settings.selected.time&&(i+=" "+c.settings.selected.time),r.hour12=24!==c.settings.selection.time,r.hour="numeric",r.minute="numeric"),o=new Date(i).toLocaleString([],r),a.val(o),s.val(i))}var g=t.find(".drts-form-datepicker-calendar"),f=new VanillaCalendar(g.get(0),c);f.init(),a.off("focus.sabai").on("focus.sabai",function(e){g.is(":visible")||g.show()}),document.addEventListener("click",function(e){g.is(":visible")&&(e.target.closest("#"+t.attr("id"))||u(e.target).is("[class^=vanilla-calendar]")||u(e.target).hasClass("drtsform-datepicker-date")?a.trigger("focus.sabai"):g.hide())}),t.off("click.sabai").on("click.sabai",".drts-clear",function(){f.reset(),g.hide(),u(this).css("visibility","hidden").parent().find(".drts-form-datepicker-date").val("").end().find(".drts-form-datepicker-date-val").val("").end().closest("form").trigger("change.sabai")}),t.closest(".drts-form-field").off("entity_reset_form_field.sabai").on("entity_reset_form_field.sabai",function(){u(this).find(".drts-form-datepicker-date").val("").end().find(".drts-form-datepicker-date-val").val("")})}},u(DRTS).on("clonefield.sabai",function(e,t){(t.clone.hasClass("drts-form-type-datepicker")||t.clone.hasClass("drts-form-type-daterangepicker")||t.clone.hasClass("drts-form-type-monthpicker"))&&t.clone.find(".drts-form-datepicker-inputs").each(function(){DRTS.Form.field.datepicker(u(this))})})}(jQuery);