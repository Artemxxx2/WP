"use strict";!function(g){DRTS.Voting=DRTS.Voting||{},DRTS.Voting.rating=DRTS.Voting.rating||function(t,a){var n=g(t);if(n.length&&!n.data("vote-rating-initialized")){n.data("vote-rating-initialized",!0);var i=n.find("select");if(i.length){var o=i.val();a=a||{},n.data("vote-url")&&(a.url=n.data("vote-url")),n.data("vote-rating")&&(a.initialRating=n.data("vote-rating"));var r=g.extend({},DRTS.Voting.rating.defaults,a);r.url&&(r.onSelect=function(t,a,e){e&&(i.barrating("readonly",!0),n.fadeTo(600,.4,function(){g.ajax({url:r.url,type:"post",data:"value="+(t||o),complete:function(t){try{var e=JSON.parse(t.responseText.replace(/<!--[\s\S]*?-->/g,""))}catch(t){return void console.log(t.toString())}278==t.status||200==t.status?n.fadeTo(600,.1,function(){var t=void 0!==e.average&&e.average?parseFloat(e.average):0,a=void 0!==e.count?e.count?parseInt(e.count):0:1;n.parent().find(".drts-voting-rating-average").text(t.toFixed(2)).end().find(".drts-voting-rating-count").text(a),i.val(e.level).barrating("set",e.level),n.fadeTo(600,1)}):(n.fadeTo("fast",1),e.messages?DRTS.flash(e.messages,"danger"):console.log(e))}})}))}),i.barrating(r)}}},DRTS.Voting.rating.defaults={theme:"fontawesome-stars-o",url:location.href,showSelectedRating:!1,showValues:!1,allowEmpty:!0},g(".drts-voting-rating-select").each(function(){DRTS.Voting.rating(g(this))}),g(DRTS).on("drts_init.sabai",function(t,a){g(".drts-voting-rating-select",a.context).each(function(){DRTS.Voting.rating(g(this))})})}(jQuery);