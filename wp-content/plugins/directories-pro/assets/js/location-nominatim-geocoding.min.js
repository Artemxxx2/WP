"use strict";!function(n){DRTS.Location.api.geocode=function(o,r,t){var e={format:"json",limit:1,q:o,"accept-language":DRTS_Location_nominatimGeocoding.language};console.log("Nominatim geocoding request:",e),n.getJSON("https://nominatim.openstreetmap.org/search",e).done(function(o){if(console.log("Nominatim geocoding results:",o),!o.length){var e=new Error(DRTS_Location_apiErrors["Geocoder returned no address components."]);if(t)return void t(e);throw e}r([o[0].lat,o[0].lon])}).fail(function(o,e,r){var n=new Error(DRTS.sprintf(DRTS_Location_apiErrors["Geocoder failed due to: %s"],r+"("+e+")"));if(!t)throw n;t(n)})},DRTS.Location.api._reverseGeocode=function(o,i,a){var e={format:"json",addressdetails:1,zoom:18,lat:o[0],lon:o[1],"accept-language":DRTS_Location_nominatimGeocoding.language};console.log("Nominatim reverse geocoding request:",e),n.getJSON("https://nominatim.openstreetmap.org/reverse",e).done(function(o){if(console.log("Nominatim reverse geocoding results:",o),o.error){var e=new Error(o.error);if(a)return void a(e);throw e}if(!1 in o||!1 in o){var r=new Error(DRTS_Location_apiErrors["Geocoder returned no address components."]);if(a)return void a(r);throw r}var n={address:o.display_name,viewport:[o.boundingbox[0],o.boundingbox[2],o.boundingbox[1],o.boundingbox[3]]};for(var t in o.address)switch(t){case"road":n.street=o.address[t];break;case"village":n.city=o.address[t];break;case"state":n.province=o.address[t];break;case"postcode":n.zip=o.address[t];break;case"country_code":n.country=o.address[t].toUpperCase();break;default:n[t]=o.address[t]}"house_number"in n&&"street"in n&&(DRTS_Location_nominatimGeocoding.house_number_pos&&"after"===DRTS_Location_nominatimGeocoding.house_number_pos?n.street=n.street+" "+n.house_number:n.street=n.house_number+" "+n.street),i(n)}).fail(function(o,e,r){var n=new Error(DRTS.sprintf(DRTS_Location_apiErrors["Geocoder failed due to: %s"],r+"("+e+")"));if(!a)throw n;a(n)})}}(jQuery);