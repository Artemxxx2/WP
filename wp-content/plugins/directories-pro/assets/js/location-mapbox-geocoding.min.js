"use strict";!function(a){DRTS.Location.api.geocode=function(o,r,t){var e="https://api.mapbox.com/geocoding/v5/mapbox.places/"+encodeURIComponent(o)+".json",n={access_token:DRTS_Location_mapboxGeocoding.accessToken,language:DRTS_Location_mapboxGeocoding.language,limit:1};DRTS_Location_mapboxGeocoding.country&&(n.country=DRTS_Location_mapboxGeocoding.country),console.log("Mapbox geocoding url:",e),console.log("Mapbox geocoding request:",n),a.getJSON(e,n).done(function(o){if(console.log("Mapbox geocoding results:",o),!1 in o||!o.features.length){var e=new Error(DRTS_Location_apiErrors["Geocoder returned no address components."]);if(t)return void t(e);throw e}r([o.features[0].center[1],o.features[0].center[0]])}).fail(function(o,e,r){var n=new Error(DRTS.sprintf(DRTS_Location_apiErrors["Geocoder failed due to: %s"],r+"("+e+")"));if(!t)throw n;t(n)})},DRTS.Location.api._reverseGeocode=function(o,u,g){var e="https://api.mapbox.com/geocoding/v5/mapbox.places/"+encodeURIComponent(o[1]+","+o[0])+".json",r={access_token:DRTS_Location_mapboxGeocoding.accessToken,language:DRTS_Location_mapboxGeocoding.language,limit:1};DRTS_Location_mapboxGeocoding.country&&(r.country=DRTS_Location_mapboxGeocoding.country),console.log("Mapbox reverse geocoding url:",e),console.log("Mapbox reverse geocoding request:",r),a.getJSON(e,r).done(function(o){if(console.log("Mapbox reverse geocoding results:",o),!1 in o||!o.features.length){var e=new Error(DRTS_Location_apiErrors["Geocoder returned no address components."]);if(g)return void g(e);throw e}var r={address:o.features[0].place_name,street:[o.features[0].address||"",o.features[0].text||""].join(" ")};o.features[0].bbox&&(r.viewport=[o.features[0].bbox[1],o.features[0].bbox[0],o.features[0].bbox[3],o.features[0].bbox[2]]);var n=void 0,t=!0,a=!1,c=void 0;try{for(var i,s=o.features[0].context[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var d=i.value;switch(n=d.id.substr(0,d.id.indexOf("."))){case"place":r.city=d.text;break;case"region":r.province=d.text;break;case"postcode":r.zip=d.text;break;case"country":r.country=d.short_code.toUpperCase();break;default:r[n]=d.text}}}catch(e){a=!0,c=e}finally{try{!t&&s.return&&s.return()}finally{if(a)throw c}}u(r)}).fail(function(o,e,r){var n=new Error(DRTS.sprintf(DRTS_Location_apiErrors["Geocoder failed due to: %s"],r+"("+e+")"));if(!g)throw n;g(n)})}}(jQuery);